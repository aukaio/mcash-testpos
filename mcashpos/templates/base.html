{% load staticfiles %}
<html>
<head>
    <title>
        {% block title %}
        {% endblock %}
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="{% static 'lib/jquery.js' %}"></script>
    <script src="{% static 'lib/pusher.min.js' %}"></script>
    <script src="{% static 'lib/bootstrap/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'pos.js' %}"></script>
    <link href="{% static 'lib/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet" media="screen">
    <link href="{% static 'custom.css' %}" rel="stylesheet" media="screen">
    <script type="text/javascript">
        window.cartId = '{{ cart_id }}';
        console.log('Cart ID: ' + cartId);
        {% autoescape off %}
        var posSettings = {{ pos_settings.as_json }};
        {% endautoescape %}
        $(document).ready(function() {
            window.pos = new Pos(posSettings, cartId);
        });
        var pusher = new Pusher(posSettings.pusherAppKey);
        pusher.subscribe(cartId);
        pusher.bind('qr-scan', function(data) {
            var img = $('#qr-image');
            var innerContainer = $('#qr-container-inner');
            innerContainer.height(img.height()).width(img.width());
            img.parent().slideUp(200, function() {
                $('#qr-status').html('QR scanned: ' + data.token).fadeIn('fast');
            });
            pos.putPaymentRequest(data.token, '10.00', 'Hello world');
        });
        console.log(posSettings)
    </script>
    {% block head-extra %}
    {% endblock %}
</head>
<body>
    {% block body %}
        <div id="content" class="container">
            {% block content %}
            {% endblock %}
        </div>
    {% endblock %}
<div class="modal hide fade" id="waitmodal" data-backdrop="static">
    <div class="modal-header">
       Waiting for payment.
    </div>
    <div class="modal-body">

    </div>
    <div class="modal-footer">

    </div>
</div>
</body>
</html>